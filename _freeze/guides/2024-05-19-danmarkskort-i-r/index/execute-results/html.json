{
  "hash": "a875c35496f20f632889b20d0e8e7722",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Nemt Danmarkskort i R\ncitation:\n  url: https://aleksanderbl.dk/guides/2024-05-19-danmarkskort-i-r\nbibliography: refs.bib\ndate: 2024-05-19\n---\n\n\n## Baggrund\n\nDa jeg skulle lære at lave kort i R, lavede jeg et par hurtige googlesøgninger, hvor jeg kom frem til en god guide lavet af Mikkel Freltoft @krogsholm2021. Jeg opdagede dog hurtigt, at guiden er out-of-date - og derfor skriver jeg denne guide.\n\n## Pakker\n\nI R-universet findes der flere pakker til at arbejde med kort. Jeg har valgt at bruge `sf`som den pakke jeg sætter mig ind i, hvad kan. De fleste kan grundlæggende det samme og er bygget op omkring `geometry`, der er de figurer der skaber kortene.\n\nFørst indlæser vi alle pakker der skal bruges.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(logger)\nlibrary(ggthemes)\nlibrary(sf)\nlibrary(rmapshaper)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Forhøjer timeout\nlog_info(paste(\"Timeout er på\", getOption(\"timeout\")))\nlog_info(\"Ændrer timeout til 600\")\noptions(timeout = 600)\n\n## Gemmer URL til API-kald\nurl <- \"https://api.dataforsyningen.dk/afstemningsomraader?format=geojson\"\n\n# Henter geojson til tempfile\ngeofile_afstemningssteder <- tempfile()\n\nlog_info(\"Starter download af geoJSON\")\nstarttid <- Sys.time()\ndownload.file(url, geofile_afstemningssteder)\nsluttid <- Sys.time()\nlog_info(\"GeoJSON downloadet\")\n\ndownload_tid <- sluttid - starttid\nlog_info(paste(\"Det tog\", round(download_tid, 3), \"minutter at downloade\"))\n\n# Læser datafilen ind i R\ngeodata_afstemningssteder <- st_read(geofile_afstemningssteder)\n\nvind_afstemningssteder_geodata <- st_as_sf(geodata_afstemningssteder)\n\n## Nulstiller timeout\noptions(timeout = 60)\n\nsf_use_s2(FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvind_afstemningssteder_geodata <- ms_simplify(vind_afstemningssteder_geodata, keep = 0.01, keep_shapes = TRUE)\n\naarhus_afstemningssteder <- vind_afstemningssteder_geodata %>%\n  filter(kommunenavn == \"Aarhus\") %>%\n  ggplot(aes(fill = navn)) +\n  geom_sf() +\n  theme_map() +\n  theme(legend.position = \"none\")\n\nbw_afstemningssteder <- ggplot(vind_afstemningssteder_geodata) +\n  geom_sf() +\n  theme_map() +\n  labs(title = \"Afstemningssteder i Danmark\", caption = \"Kilde: DAWA/DAGI\") +\n  theme(legend.position = \"none\", title = element_text(size = 20))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naarhus_afstemningssteder\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbw_afstemningssteder\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}